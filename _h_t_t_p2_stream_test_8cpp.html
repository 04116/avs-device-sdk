<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AlexaClientSDK: /Users/sdy/AVS_CPP_SDK/github/alexa-client-sdk/ACL/test/Transport/HTTP2StreamTest.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="avs-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AlexaClientSDK
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
   <div id="projectbrief">A cross-platform, modular SDK for interacting with the Alexa Voice Service</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b1dfedc9efa610ba8c818c30206ff41f.html">ACL</a></li><li class="navelem"><a class="el" href="dir_2df864b0a635213c7e15391c7fd2f9dc.html">test</a></li><li class="navelem"><a class="el" href="dir_533d2869dc4e8069af67bd5b3d31045b.html">Transport</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">HTTP2StreamTest.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;memory&gt;</code><br />
<code>#include &lt;random&gt;</code><br />
<code>#include &lt;gtest/gtest.h&gt;</code><br />
<code>#include &lt;curl/curl.h&gt;</code><br />
<code>#include &lt;ACL/Transport/HTTP2Stream.h&gt;</code><br />
<code>#include &lt;AVSCommon/AVS/Initialization/AlexaClientSDKInit.h&gt;</code><br />
<code>#include &lt;AVSCommon/Utils/SDS/InProcessSDS.h&gt;</code><br />
<code>#include &lt;AVSCommon/AVS/Attachment/InProcessAttachmentReader.h&gt;</code><br />
<code>#include &quot;TestableConsumer.h&quot;</code><br />
<code>#include &quot;MockMessageRequest.h&quot;</code><br />
<code>#include &quot;Common/Common.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for HTTP2StreamTest.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="_h_t_t_p2_stream_test_8cpp__incl.png" border="0" usemap="#_2_users_2sdy_2_a_v_s___c_p_p___s_d_k_2github_2alexa-client-sdk_2_a_c_l_2test_2_transport_2_h_t_t_p2_stream_test_8cpp" alt=""/></div>
<map name="_2_users_2sdy_2_a_v_s___c_p_p___s_d_k_2github_2alexa-client-sdk_2_a_c_l_2test_2_transport_2_h_t_t_p2_stream_test_8cpp" id="_2_users_2sdy_2_a_v_s___c_p_p___s_d_k_2github_2alexa-client-sdk_2_a_c_l_2test_2_transport_2_h_t_t_p2_stream_test_8cpp">
<area shape="rect" id="node6" href="_h_t_t_p2_stream_8h_source.html" title="ACL/Transport/HTTP2Stream.h" alt="" coords="931,119,1139,144"/>
<area shape="rect" id="node18" href="_in_process_s_d_s_8h_source.html" title="AVSCommon/Utils/SDS\l/InProcessSDS.h" alt="" coords="2262,539,2424,577"/>
<area shape="rect" id="node44" href="_alexa_client_s_d_k_init_8h_source.html" title="AVSCommon/AVS/Initialization\l/AlexaClientSDKInit.h" alt="" coords="3285,872,3489,911"/>
<area shape="rect" id="node45" href="_in_process_attachment_reader_8h_source.html" title="AVSCommon/AVS/Attachment\l/InProcessAttachmentReader.h" alt="" coords="2261,452,2467,491"/>
<area shape="rect" id="node46" href="_testable_consumer_8h_source.html" title="TestableConsumer.h" alt="" coords="3505,199,3648,224"/>
<area shape="rect" id="node48" href="_mock_message_request_8h_source.html" title="MockMessageRequest.h" alt="" coords="255,545,423,571"/>
<area shape="rect" id="node50" href="_a_c_l_2test_2_transport_2_common_2_common_8h_source.html" title="Common/Common.h" alt="" coords="5,372,150,397"/>
<area shape="rect" id="node11" href="_attachment_manager_8h_source.html" title="AVSCommon/AVS/Attachment\l/AttachmentManager.h" alt="" coords="1807,279,2009,317"/>
<area shape="rect" id="node36" href="_message_request_8h_source.html" title="AVSCommon/AVS/MessageRequest.h" alt="" coords="698,625,947,651"/>
<area shape="rect" id="node38" href="_message_request_observer_interface_8h_source.html" title="AVSCommon/SDKInterfaces\l/MessageRequestObserverInterface.h" alt="" coords="317,699,563,737"/>
<area shape="rect" id="node39" href="_curl_easy_handle_wrapper_8h_source.html" title="ACL/Transport/CurlEasyHandle\lWrapper.h" alt="" coords="688,192,896,231"/>
<area shape="rect" id="node40" href="_mime_parser_8h.html" title="ACL/Transport/MimeParser.h" alt="" coords="1403,199,1597,224"/>
<area shape="rect" id="node43" href="_message_consumer_interface_8h_source.html" title="ACL/Transport/MessageConsumer\lInterface.h" alt="" coords="1123,279,1350,317"/>
<area shape="rect" id="node13" href="_attachment_manager_interface_8h_source.html" title="AVSCommon/AVS/Attachment\l/AttachmentManagerInterface.h" alt="" coords="1451,365,1659,404"/>
<area shape="rect" id="node14" href="_attachment_8h_source.html" title="AVSCommon/AVS/Attachment\l/Attachment.h" alt="" coords="1593,452,1794,491"/>
<area shape="rect" id="node15" href="_attachment_reader_8h_source.html" title="AVSCommon/AVS/Attachment\l/AttachmentReader.h" alt="" coords="1579,699,1781,737"/>
<area shape="rect" id="node17" href="_attachment_writer_8h_source.html" title="AVSCommon/AVS/Attachment\l/AttachmentWriter.h" alt="" coords="1883,539,2085,577"/>
<area shape="rect" id="node21" href="_shared_data_stream_8h_source.html" title="SharedDataStream.h" alt="" coords="2388,625,2535,651"/>
<area shape="rect" id="node23" href="_logger_utils_8h_source.html" title="AVSCommon/Utils/Logger\l/LoggerUtils.h" alt="" coords="2410,785,2585,824"/>
<area shape="rect" id="node31" href="_buffer_layout_8h_source.html" title="BufferLayout.h" alt="" coords="2362,705,2470,731"/>
<area shape="rect" id="node32" href="_reader_8h_source.html" title="Reader.h" alt="" coords="2757,705,2833,731"/>
<area shape="rect" id="node35" href="_writer_8h_source.html" title="Writer.h" alt="" coords="2589,705,2656,731"/>
<area shape="rect" id="node24" href="_logger_8h_source.html" title="AVSCommon/Utils/Logger\l/Logger.h" alt="" coords="2550,872,2725,911"/>
<area shape="rect" id="node26" href="_configuration_node_8h_source.html" title="AVSCommon/Utils/Configuration\l/ConfigurationNode.h" alt="" coords="2397,959,2611,997"/>
<area shape="rect" id="node28" href="_level_8h_source.html" title="AVSCommon/Utils/Logger\l/Level.h" alt="" coords="2560,1045,2736,1084"/>
<area shape="rect" id="node29" href="_log_entry_8h_source.html" title="AVSCommon/Utils/Logger\l/LogEntry.h" alt="" coords="2907,959,3083,997"/>
<area shape="rect" id="node30" href="_log_level_observer_interface_8h_source.html" title="AVSCommon/Utils/Logger\l/LogLevelObserverInterface.h" alt="" coords="2686,959,2883,997"/>
<area shape="rect" id="node47" href="_message_observer_interface_8h_source.html" title="AVSCommon/SDKInterfaces\l/MessageObserverInterface.h" alt="" coords="3614,279,3811,317"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classalexa_client_s_d_k_1_1acl_1_1test_1_1_h_t_t_p2_stream_test.html">alexaClientSDK::acl::test::HTTP2StreamTest</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a19be509566dda404a6fa23353bc1c521"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#a19be509566dda404a6fa23353bc1c521">alexaClientSDK::acl::test::TEST_F</a> (HTTP2StreamTest, testExceptionReceivedSingleWrite)</td></tr>
<tr class="separator:a19be509566dda404a6fa23353bc1c521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a1c0495cb4481463ac25354b8bf2bcf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#a7a1c0495cb4481463ac25354b8bf2bcf">alexaClientSDK::acl::test::TEST_F</a> (HTTP2StreamTest, testExceptionReceivedMultiWrite)</td></tr>
<tr class="separator:a7a1c0495cb4481463ac25354b8bf2bcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a589d62f0a49e42f25b7131a0f72171f4"><td class="memItemLeft" align="right" valign="top"><a id="a589d62f0a49e42f25b7131a0f72171f4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>alexaClientSDK::acl::test::TEST_F</b> (HTTP2StreamTest, testHeaderCallback)</td></tr>
<tr class="separator:a589d62f0a49e42f25b7131a0f72171f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d1b7f6c0f0f16170a7482f21d7ec92a"><td class="memItemLeft" align="right" valign="top"><a id="a2d1b7f6c0f0f16170a7482f21d7ec92a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>alexaClientSDK::acl::test::TEST_F</b> (HTTP2StreamTest, testReadCallBack)</td></tr>
<tr class="separator:a2d1b7f6c0f0f16170a7482f21d7ec92a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top"><a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a231fd405d7b68196122387803d8d9a9b"><td class="memItemLeft" align="right" valign="top"><a id="a231fd405d7b68196122387803d8d9a9b"></a>
static const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#a231fd405d7b68196122387803d8d9a9b">alexaClientSDK::acl::test::LIBCURL_TEST_URL</a> = &quot;http://example.com&quot;</td></tr>
<tr class="memdesc:a231fd405d7b68196122387803d8d9a9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">A test url with which to initialize our test stream object. <br /></td></tr>
<tr class="separator:a231fd405d7b68196122387803d8d9a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53d86ae55627103156e1b77226eb181b"><td class="memItemLeft" align="right" valign="top"><a id="a53d86ae55627103156e1b77226eb181b"></a>
static const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#a53d86ae55627103156e1b77226eb181b">alexaClientSDK::acl::test::LIBCURL_TEST_AUTH_STRING</a> = &quot;test_auth_string&quot;</td></tr>
<tr class="memdesc:a53d86ae55627103156e1b77226eb181b"><td class="mdescLeft">&#160;</td><td class="mdescRight">A test auth string with which to initialize our test stream object. <br /></td></tr>
<tr class="separator:a53d86ae55627103156e1b77226eb181b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af26685c602bd79985b0de06ea4bc8145"><td class="memItemLeft" align="right" valign="top"><a id="af26685c602bd79985b0de06ea4bc8145"></a>
static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#af26685c602bd79985b0de06ea4bc8145">alexaClientSDK::acl::test::TEST_EXCEPTION_STRING_LENGTH</a> = 200</td></tr>
<tr class="memdesc:af26685c602bd79985b0de06ea4bc8145"><td class="mdescLeft">&#160;</td><td class="mdescRight">The length of the string we will test for the exception message. <br /></td></tr>
<tr class="separator:af26685c602bd79985b0de06ea4bc8145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8d197f3e8aadd5e9cb0588781ee438"><td class="memItemLeft" align="right" valign="top"><a id="adc8d197f3e8aadd5e9cb0588781ee438"></a>
static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#adc8d197f3e8aadd5e9cb0588781ee438">alexaClientSDK::acl::test::TEST_EXCEPTION_PARTITIONS</a> = 7</td></tr>
<tr class="memdesc:adc8d197f3e8aadd5e9cb0588781ee438"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of iterations the multi-write test will perform. <br /></td></tr>
<tr class="separator:adc8d197f3e8aadd5e9cb0588781ee438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9f22d81a2dfb6db3fa1cf1c669dabd3"><td class="memItemLeft" align="right" valign="top"><a id="ab9f22d81a2dfb6db3fa1cf1c669dabd3"></a>
static const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#ab9f22d81a2dfb6db3fa1cf1c669dabd3">alexaClientSDK::acl::test::SDS_WORDSIZE</a> = 1</td></tr>
<tr class="memdesc:ab9f22d81a2dfb6db3fa1cf1c669dabd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes per word in the SDS circular buffer. <br /></td></tr>
<tr class="separator:ab9f22d81a2dfb6db3fa1cf1c669dabd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2963d2aaab32d1f996c0fb468c974aa"><td class="memItemLeft" align="right" valign="top"><a id="ad2963d2aaab32d1f996c0fb468c974aa"></a>
static const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#ad2963d2aaab32d1f996c0fb468c974aa">alexaClientSDK::acl::test::SDS_MAXREADERS</a> = 1</td></tr>
<tr class="memdesc:ad2963d2aaab32d1f996c0fb468c974aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of readers to support in the SDS circular buffer. <br /></td></tr>
<tr class="separator:ad2963d2aaab32d1f996c0fb468c974aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d235abb08e8aec103279812b2cd142d"><td class="memItemLeft" align="right" valign="top"><a id="a1d235abb08e8aec103279812b2cd142d"></a>
static const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#a1d235abb08e8aec103279812b2cd142d">alexaClientSDK::acl::test::SDS_WORDS</a> = 300</td></tr>
<tr class="memdesc:a1d235abb08e8aec103279812b2cd142d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of words to hold in the SDS circular buffer. <br /></td></tr>
<tr class="separator:a1d235abb08e8aec103279812b2cd142d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6d2c69057ef77afaaaafbc982329cec"><td class="memItemLeft" align="right" valign="top"><a id="ae6d2c69057ef77afaaaafbc982329cec"></a>
static const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_h_t_t_p2_stream_test_8cpp.html#ae6d2c69057ef77afaaaafbc982329cec">alexaClientSDK::acl::test::NUMBER_OF_STRINGS</a> = 1</td></tr>
<tr class="memdesc:ae6d2c69057ef77afaaaafbc982329cec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of strings to read/write for the test. <br /></td></tr>
<tr class="separator:ae6d2c69057ef77afaaaafbc982329cec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="file_a19be509566dda404a6fa23353bc1c521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a19be509566dda404a6fa23353bc1c521">&#9670;&nbsp;</a></span>TEST_F() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">alexaClientSDK::acl::test::TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classalexa_client_s_d_k_1_1acl_1_1test_1_1_h_t_t_p2_stream_test.html">HTTP2StreamTest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">testExceptionReceivedSingleWrite&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Let's simulate that AVSConnectionManager-&gt;send() has been invoked, and the messageRequest object is waiting to be notified on the response from AVS. We will invoke the stream writeCallbacks directly to simulate exception data returning from AVS, and verify that the stream passes the correct data back to the request object. </p>

</div>
</div>
<a id="file_a7a1c0495cb4481463ac25354b8bf2bcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#file_a7a1c0495cb4481463ac25354b8bf2bcf">&#9670;&nbsp;</a></span>TEST_F() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">alexaClientSDK::acl::test::TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classalexa_client_s_d_k_1_1acl_1_1test_1_1_h_t_t_p2_stream_test.html">HTTP2StreamTest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">testExceptionReceivedMultiWrite&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The same test as above, but now with multiple writes (simulating either a small buffer from libcurl, or a very long exception message). </p>

</div>
</div>
</div><!-- contents -->
<html>
  <body>
    <p style="text-align:left;">
      AlexaClientSDK 1.1.0 - Copyright 2016-2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
      <span style="float:right;">
	Licensed under the <a HREF=http://aws.amazon.com/apache2.0/>Apache License, Version 2.0</a>
      </span>
    </p>
  </body>
</html>
